---
manual:WebAPI
version:0
lang:zh
rawUrl:https://developer.mozilla.org/zh-CN/docs/Web/API/AudioProcessingEvent
---



<bdi>我们的志愿者还没有将这篇文章翻译为<bdi>中文 (简体)</bdi>。[加入我们帮助完成翻译](%3937 "")<br></br>您也可以阅读此文章的[English (US)](%3938 "")版。</bdi>






**Deprecated**<br></br>This feature has been removed from the Web standards. Though some browsers may still support it, it is in the process of being dropped. Avoid using it and update existing code if possible; see the[compatibility table](%3939 "")at the bottom of this page to guide your decision. Be aware that this feature may cease to work at any time.




The[Web Audio API](%3940 "/en-US/docs/Web_Audio_API")`AudioProcessingEvent`represents events that occur when a[`ScriptProcessorNode`](%3941 "")input buffer is ready to be processed.



**Note**: As of the August 29 2014 Web Audio API spec publication, this feature has been marked as deprecated, and is soon to be replaced by[AudioWorklet](%3942 "").



## Properties<a name="Properties"></a>


<em>The list below includes the properties inherited from its parent,[`Event`](%3943 "The Event interface represents any event which takes place in the DOM; some are user-generated (such as mouse or keyboard events), while others are generated by APIs (such as events that indicate an animation has finished running, a video has been paused, and so forth). There are many types of events, some of which use other interfaces based on the main Event interface. Event itself contains the properties and methods which are common to all events.")</em>.

Property | Type | Description 
 ---  |  ---  |  ---  | 
`target`Read only | [`EventTarget`](%3944 "EventTarget is an interface implemented by objects that can receive events and may have listeners for them.") | The event target (the topmost target in the DOM tree). 
`type`Read only | [`DOMString`](%3945 "DOMString is a UTF-16 String. As JavaScript already uses such strings, DOMString is mapped directly to a String.") | The type of event. 
`bubbles`Read only | `boolean` | Does the event normally bubble? 
`cancelable`Read only | `boolean` | Is it possible to cancel the event? 
`playbackTime`Read only | `double` | The time when the audio will be played, as defined by the time of[`AudioContext.currentTime`](%3946 "The documentation about this has not yet been written; please consider contributing!") 
`inputBuffer`Read only | [`AudioBuffer`](%3836 "Objects of these types are designed to hold small audio snippets, typically less than 45 s. For longer sounds, objects implementing the MediaElementAudioSourceNode are more suitable. The buffer contains data in the following format:  non-interleaved IEEE754 32-bit linear PCM with a nominal range between -1 and +1, that is, 32bits floating point buffer, with each samples between -1.0 and 1.0. If the AudioBuffer has multiple channels, they are stored in separate buffer.") | The buffer containing the input audio data to be processed. The number of channels is defined as a parameter,`numberOfInputChannels`, of the factory method[`AudioContext.createScriptProcessor()`](%3947 "The documentation about this has not yet been written; please consider contributing!"). Note the the returned`AudioBuffer`is only valid in the scope of the`onaudioprocess`function. 
`outputBuffer`Read only | [`AudioBuffer`](%3836 "Objects of these types are designed to hold small audio snippets, typically less than 45 s. For longer sounds, objects implementing the MediaElementAudioSourceNode are more suitable. The buffer contains data in the following format:  non-interleaved IEEE754 32-bit linear PCM with a nominal range between -1 and +1, that is, 32bits floating point buffer, with each samples between -1.0 and 1.0. If the AudioBuffer has multiple channels, they are stored in separate buffer.") | The buffer where the output audio data should be written. The number of channels is defined as a parameter,`numberOfOutputChannels`, of the factory method[`AudioContext.createScriptProcessor()`](%3947 "The documentation about this has not yet been written; please consider contributing!"). Note the the returned`AudioBuffer`is only valid in the scope of the`onaudioprocess`function. 


## Example<a name="Example"></a>


The following example shows basic usage of a`ScriptProcessorNode`to take a track loaded via[`AudioContext.decodeAudioData()`](%3948 "The documentation about this has not yet been written; please consider contributing!"), process it, adding a bit of white noise to each audio sample of the input track (buffer) and play it through the[`AudioDestinationNode`](%3949 "AudioDestinationNode has no output (as it is the output, no more AudioNode can be linked after it in the audio graph) and one input. The number of channels in the input must be between 0 and the maxChannelCount value or an exception is raised."). For each channel and each sample frame, the`scriptNode.onaudioprocess`function takes the associated`audioProcessingEvent`and uses it to loop through each channel of the input buffer, and each sample in each channel, and add a small amount of white noise, before setting that result to be the output sample in each case.



**Note**: For a full working example, see our[script-processor-node](%3950 "")github repo (also view the[source code](%3951 "").)



```
var myScript = document.querySelector('script');
var myPre = document.querySelector('pre');
var playButton = document.querySelector('button');
      
// Create AudioContext and buffer source
var audioCtx = new AudioContext();
source = audioCtx.createBufferSource();

// Create a ScriptProcessorNode with a bufferSize of 4096 and a single input and output channel
var scriptNode = audioCtx.createScriptProcessor(4096, 1, 1);
console.log(scriptNode.bufferSize);

// load in an audio track via XHR and decodeAudioData

function getData() {
  request = new XMLHttpRequest();
  request.open('GET', 'viper.ogg', true);
  request.responseType = 'arraybuffer';
  request.onload = function() {
    var audioData = request.response;

    audioCtx.decodeAudioData(audioData, function(buffer) {
    myBuffer = buffer;   
    source.buffer = myBuffer;
  },
    function(e){"Error with decoding audio data" + e.err});
  }
  request.send();
}

// Give the node a function to process audio events
scriptNode.onaudioprocess = function(audioProcessingEvent) {
  // The input buffer is the song we loaded earlier
  var inputBuffer = audioProcessingEvent.inputBuffer;

  // The output buffer contains the samples that will be modified and played
  var outputBuffer = audioProcessingEvent.outputBuffer;

  // Loop through the output channels (in this case there is only one)
  for (var channel = 0; channel < outputBuffer.numberOfChannels; channel++) {
    var inputData = inputBuffer.getChannelData(channel);
    var outputData = outputBuffer.getChannelData(channel);

    // Loop through the 4096 samples
    for (var sample = 0; sample < inputBuffer.length; sample++) {
      // make output equal to the same as the input
      outputData[sample] = inputData[sample];

      // add noise to each output sample
      outputData[sample] += ((Math.random() * 2) - 1) * 0.2;         
    }
  }
}

getData();

// wire up play button
playButton.onclick = function() {
  source.connect(scriptNode);
  scriptNode.connect(audioCtx.destination);
  source.start();
}
      
// When the buffer source stops playing, disconnect everything
source.onended = function() {
  source.disconnect(scriptNode);
  scriptNode.disconnect(audioCtx.destination);
}
```

## Specifications<a name="Specifications"></a>
Specification | Status | Comment 
[Web Audio API<br></br><small>The definition of &#39;AudioProcessingEvent&#39; in that specification.</small>](%3952 "") | Working Draft |  


## Browser compatibility<a name="Browser_compatibility"></a>
[新的兼容性表格正在测试中<i></i>](%3360 "")
<abbr>Desktop<i></i></abbr> | <abbr>Mobile<i></i></abbr> 
<abbr>Chrome<i></i></abbr> | <abbr>Edge<i></i></abbr> | <abbr>Firefox<i></i></abbr> | <abbr>Internet Explorer<i></i></abbr> | <abbr>Opera<i></i></abbr> | <abbr>Safari<i></i></abbr> | <abbr>Android webview<i></i></abbr> | <abbr>Chrome for Android<i></i></abbr> | <abbr>Edge Mobile<i></i></abbr> | <abbr>Firefox for Android<i></i></abbr> | <abbr>Opera for Android<i></i></abbr> | <abbr>iOS Safari<i></i></abbr> | <abbr>Samsung Internet<i></i></abbr> 
 ---  |  ---  |  ---  |  ---  |  ---  |  ---  |  ---  |  ---  |  ---  |  ---  |  ---  |  ---  |  ---  |  ---  | 
Basic support<abbr>Deprecated<i></i></abbr> | <abbr>Full support</abbr>14 | <abbr>Full support</abbr>Yes | <abbr>Full support</abbr>25 | <abbr>No support</abbr>No | <abbr>Full support</abbr>15 | <abbr>Full support</abbr>6 | <abbr>Full support</abbr>Yes | <abbr>Full support</abbr>14 | <abbr>Full support</abbr>Yes | <abbr>Full support</abbr>26 | <abbr>Full support</abbr>15 | <abbr>?</abbr> | <abbr>Full support</abbr>Yes 
[`inputBuffer`](%3953 "")<abbr>Deprecated<i></i></abbr> | <abbr>Full support</abbr>14 | <abbr>Full support</abbr>12 | <abbr>Full support</abbr>25 | <abbr>No support</abbr>No | <abbr>Full support</abbr>15 | <abbr>Full support</abbr>6 | <abbr>Full support</abbr>Yes | <abbr>Full support</abbr>14 | <abbr>Full support</abbr>Yes | <abbr>Full support</abbr>26 | <abbr>Full support</abbr>15 | <abbr>?</abbr> | <abbr>Full support</abbr>Yes 
[`outputBuffer`](%3954 "")<abbr>Deprecated<i></i></abbr> | <abbr>Full support</abbr>14 | <abbr>Full support</abbr>12 | <abbr>Full support</abbr>25 | <abbr>No support</abbr>No | <abbr>Full support</abbr>15 | <abbr>Full support</abbr>6 | <abbr>Full support</abbr>Yes | <abbr>Full support</abbr>14 | <abbr>Full support</abbr>Yes | <abbr>Full support</abbr>26 | <abbr>Full support</abbr>15 | <abbr>?</abbr> | <abbr>Full support</abbr>Yes 
[`playbackTime`](%3955 "")<abbr>Deprecated<i></i></abbr> | <abbr>Full support</abbr>14 | <abbr>Full support</abbr>12 | <abbr>Full support</abbr>25 | <abbr>No support</abbr>No | <abbr>Full support</abbr>15 | <abbr>Full support</abbr>6 | <abbr>Full support</abbr>Yes | <abbr>Full support</abbr>14 | <abbr>Full support</abbr>Yes | <abbr>Full support</abbr>26 | <abbr>Full support</abbr>15 | <abbr>?</abbr> | <abbr>Full support</abbr>Yes 


### Legend<a name="Legend"></a>
<dl><dt><abbr>Full support</abbr></dt><dd>Full support</dd><dt><abbr>No support</abbr></dt><dd>No support</dd><dt><abbr>Compatibility unknown</abbr></dt><dd>Compatibility unknown</dd><dt><abbr>Deprecated. Not for use in new websites.<i></i></abbr></dt><dd>Deprecated. Not for use in new websites.</dd></dl>


## See also<a name="See_also"></a>

* [Using the Web Audio API](%3811 "")



## 文档标签和贡献者
**标签：**
* [API](%50 "")
* [Deprecated](%3956 "")
* [Interface](%3380 "")
* [Internationalization](%3957 "")
* [Reference](%3381 "")
* [Référence(2)](%3892 "")
* [Web Audio API](%3830 "")

**此页面的贡献者：**[hoch](%3958 ""),[Havok11](%3959 ""),[fscholz](%60 ""),[erikadoyle](%3894 ""),[Sheppy](%405 ""),[chrisdavidmills](%3495 ""),[kscarfone](%3900 ""),[teoli](%160 "")
**最后编辑者:**[hoch](%3958 ""),<time>Apr 6, 2018, 1:43:55 PM</time>


